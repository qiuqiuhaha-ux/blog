(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-06209f50"],{"159b":function(t,e,n){var r=n("da84"),i=n("fdbc"),o=n("17c2"),a=n("9112");for(var s in i){var c=r[s],l=c&&c.prototype;if(l&&l.forEach!==o)try{a(l,"forEach",o)}catch(u){l.forEach=o}}},"17c2":function(t,e,n){"use strict";var r=n("b727").forEach,i=n("a640"),o=n("ae40"),a=i("forEach"),s=o("forEach");t.exports=a&&s?[].forEach:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}},"1dde":function(t,e,n){var r=n("d039"),i=n("b622"),o=n("2d00"),a=i("species");t.exports=function(t){return o>=51||!r((function(){var e=[],n=e.constructor={};return n[a]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},4160:function(t,e,n){"use strict";var r=n("23e7"),i=n("17c2");r({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},"65f0":function(t,e,n){var r=n("861d"),i=n("e8b5"),o=n("b622"),a=o("species");t.exports=function(t,e){var n;return i(t)&&(n=t.constructor,"function"!=typeof n||n!==Array&&!i(n.prototype)?r(n)&&(n=n[a],null===n&&(n=void 0)):n=void 0),new(void 0===n?Array:n)(0===e?0:e)}},"74e2":function(t,e,n){},8052:function(t,e,n){"use strict";var r=n("74e2"),i=n.n(r);i.a},"8fc4":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"message"},[n("Nav"),n("div",{staticClass:"text"},[t._m(0),n("TextA",{on:{Sub:t.handleSubmit}})],1),n("div",{staticClass:"comment"},t._l(t.commentList,(function(e,r){return n("div",{key:e._id,staticClass:"m-comment"},[n("div",{staticClass:"p-comment"},[n("img",{attrs:{src:e.user.photo,alt:""}}),n("span",{staticClass:"user"},[t._v(t._s(e.user.user))]),n("p",{domProps:{innerHTML:t._s(e.content)}}),n("div",{staticClass:"information"},[n("span",{staticClass:"time"},[t._v(t._s(t._f("getTime")(e.date)))]),n("a",{on:{click:function(e){return t.replyClick(r)}}},[t._v(" "+t._s(e.reply.lastIndexArr[0]===r&&void 0===e.reply.lastIndexArr[1]?"收起":"回复")+" ")])])]),t._l(e.children,(function(i,o){return n("div",{key:i.date+Math.random(),staticClass:"c-comment"},[n("img",{attrs:{src:i.user.photo,alt:""}}),n("span",{staticClass:"user"},[t._v(t._s(i.user.user)+" 回复了 "+t._s(i.reUser))]),n("p",{domProps:{innerHTML:t._s(i.content)}}),n("div",{staticClass:"information"},[n("span",{staticClass:"time"},[t._v(t._s(t._f("getTime")(i.date)))]),n("a",{on:{click:function(e){return t.replyClick(r,o,i)}}},[t._v(" "+t._s(e.reply.lastIndexArr[0]===r&&e.reply.lastIndexArr[1]===o?"收起":"回复")+" ")])])])})),n("div",{class:["text",{show:e.reply.ifShow}]},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.reply.content,expression:"item.reply.content"}],attrs:{placeholder:"回复【"+e.reply.$user+"】"},domProps:{value:e.reply.content},on:{input:function(n){n.target.composing||t.$set(e.reply,"content",n.target.value)}}}),n("button",{staticClass:"layui-btn layui-btn-xs",attrs:{type:"button"},on:{click:function(n){return t.childCommit(r,e)}}},[t._v("提交")])])],2)})),0)],1)},i=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"title"},[n("h2",[t._v("留言板")]),n("h4",[t._v("沟通交流,拉近你我")])])}],o=(n("99af"),n("4160"),n("159b"),n("216c")),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("textarea",{staticStyle:{display:"none"},attrs:{id:"demo"}}),n("button",{staticClass:"layui-btn",attrs:{type:"button"},on:{click:t.handleClick}},[t._v("提交留言")])])},s=[],c={data:function(){return{layedit:null,index:0}},methods:{handleClick:function(){this.$emit("Sub",this.layedit.getContent(this.index))}},mounted:function(){var t=this;layui.use("layedit",(function(){t.layedit=layui.layedit,t.index=t.layedit.build("demo",{tool:["face"]})}))}},l=c,u=n("2877"),d=Object(u["a"])(l,a,s,!1,null,"24ea7ad2",null),f=d.exports,m=n("c9ca"),h=m["a"].getIfLogin,p=m["a"].commitMessage,v=m["a"].getMessageList,y=m["a"].commitChildMessage;function g(t){return(t<10?"0":"")+t}var b={name:"message",data:function(){return{commentList:[],skip:0,limit:0,ifLoding:!1}},components:{Nav:o["a"],TextA:f},filters:{getTime:function(t){var e=new Date(t),n=g(e.getFullYear()),r=g(e.getMonth()+1),i=g(e.getDate()),o=g(e.getHours()),a=g(e.getMinutes()),s=g(e.getSeconds());return"".concat(n,"年").concat(r,"月").concat(i,"日 ").concat(o,":").concat(a,":").concat(s)}},methods:{handleSubmit:function(t){h().then((function(e){e.data.userInfo?p({user:e.data.userInfo._id,content:t}).then((function(t){10===t.data.code?layer.msg(t.data.msg,{icon:2}):(layer.msg("留言成功",{icon:1}),setTimeout((function(){window.location.reload()}),1e3))})).catch((function(){layer.msg("服务器错误~请稍后再试",{icon:2})})):layer.msg("请先登录",{icon:2})})).catch((function(){alert("服务器出错，稍后再试")}))},replyClick:function(t,e){if(void 0!==t){var n=this.commentList[t];this.commentList[t].reply.$user=void 0!==e?n.children[e].user.user:n.user.user,t===n.reply.lastIndexArr[0]&&e===n.reply.lastIndexArr[1]?(n.reply.ifShow=!1,n.reply.lastIndexArr=[]):(n.reply.ifShow=!0,n.reply.lastIndexArr=[t,e])}},childCommit:function(t,e){var n=this;h().then((function(e){e.data.userInfo?y({parentId:n.commentList[t]._id,user:e.data.userInfo._id,content:n.commentList[t].reply.content,reUser:n.commentList[t].reply.$user}).then((function(t){t.data.code?layer.msg(t.data.msg,{icon:2}):(layer.msg("评论成功",{icon:1}),setTimeout((function(){window.location.reload()}),1e3))})):layer.msg("请先登录",{icon:2})})).catch((function(){layer.msg("服务器错误~请稍后再试",{icon:2})}))},handleScroll:function(){var t=this;if(!this.ifLoding){var e=document.documentElement.offsetHeight,n=document.documentElement.scrollTop,r=document.documentElement.clientHeight;n+r>=e-200&&(this.ifLoding=!0,this.getMessageList((function(){t.ifLoding=!1})))}},getMessageList:function(t){var e=this;this.limit+=5,v(this.skip,this.limit).then((function(n){var r=n.data.data;r.forEach((function(t){t.reply={user:"",content:"",reUser:"",date:"",ifShow:!1,lastIndexArr:[]}})),e.commentList=r,t&&t()}))}},created:function(){this.getMessageList()},mounted:function(){window.addEventListener("scroll",this.handleScroll)},destroyed:function(){window.removeEventListener("scroll",this.handleScroll)}},_=b,x=(n("8052"),Object(u["a"])(_,r,i,!1,null,"3b29bd43",null));e["default"]=x.exports},"99af":function(t,e,n){"use strict";var r=n("23e7"),i=n("d039"),o=n("e8b5"),a=n("861d"),s=n("7b0b"),c=n("50c4"),l=n("8418"),u=n("65f0"),d=n("1dde"),f=n("b622"),m=n("2d00"),h=f("isConcatSpreadable"),p=9007199254740991,v="Maximum allowed index exceeded",y=m>=51||!i((function(){var t=[];return t[h]=!1,t.concat()[0]!==t})),g=d("concat"),b=function(t){if(!a(t))return!1;var e=t[h];return void 0!==e?!!e:o(t)},_=!y||!g;r({target:"Array",proto:!0,forced:_},{concat:function(t){var e,n,r,i,o,a=s(this),d=u(a,0),f=0;for(e=-1,r=arguments.length;e<r;e++)if(o=-1===e?a:arguments[e],b(o)){if(i=c(o.length),f+i>p)throw TypeError(v);for(n=0;n<i;n++,f++)n in o&&l(d,f,o[n])}else{if(f>=p)throw TypeError(v);l(d,f++,o)}return d.length=f,d}})},b727:function(t,e,n){var r=n("0366"),i=n("44ad"),o=n("7b0b"),a=n("50c4"),s=n("65f0"),c=[].push,l=function(t){var e=1==t,n=2==t,l=3==t,u=4==t,d=6==t,f=5==t||d;return function(m,h,p,v){for(var y,g,b=o(m),_=i(b),x=r(h,p,3),w=a(_.length),C=0,E=v||s,L=e?E(m,w):n?E(m,0):void 0;w>C;C++)if((f||C in _)&&(y=_[C],g=x(y,C,b),t))if(e)L[C]=g;else if(g)switch(t){case 3:return!0;case 5:return y;case 6:return C;case 2:c.call(L,y)}else if(u)return!1;return d?-1:l||u?u:L}};t.exports={forEach:l(0),map:l(1),filter:l(2),some:l(3),every:l(4),find:l(5),findIndex:l(6)}},e8b5:function(t,e,n){var r=n("c6b6");t.exports=Array.isArray||function(t){return"Array"==r(t)}}}]);
//# sourceMappingURL=chunk-06209f50.90cea31d.js.map